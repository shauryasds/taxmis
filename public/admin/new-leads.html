<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>New Leads Form - TAXMIS</title>
  <link rel="stylesheet" href="/admin/css/styles.css">
  <style>
    body {
  display: flex;
  margin: 0;
  min-height: 100vh;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: #f5f5f5;
}

.sidebar { 
  width: 250px; 
  background: #0056b3; 
  color: white; 
  padding: 20px; 
  display: flex; 
  flex-direction: column; 
}
.sidebar h2 { 
  text-align: center; 
  margin-bottom: 20px; 
}
.sidebar ul { 
  list-style: none; 
  padding: 0;
}
.sidebar ul li { 
  padding: 10px; 
  margin: 5px 0; 
  background: #003d80; 
  border-radius: 5px; 
  cursor: pointer; 
  text-align: center; 
}
.sidebar ul li:hover { 
  background: #ff6600; 
}
.main-content { 
  flex: 1; 
  padding: 20px; 
}
.header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  margin-bottom: 20px; 
}
.header h2 { 
  color: #ff6600; 
}

.logout-btn {
  background: #ff4757;
  color: white;
  padding: 8px 16px;
  border-radius: 4px;
  text-decoration: none;
  transition: background 0.3s ease;
}

.logout-btn:hover {
  background: #e84118;
}

/* Form section styling based on reference */
:root {
  --primary: #0056b3;  /* Keeping your blue */
  --secondary: #F6AD55;
  --accent: #48BB78;
  --light: #EBF8FF;
  --dark: #004494;
  --error: #dc3545;
}

form {
  width: 100%;
  max-width: 900px;
  margin: 0 auto;
  background: white;
  padding: 2rem;
  border-radius: 1rem;
  box-sizing: border-box;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  transition: transform 0.3s ease;
}

form:hover {
  transform: translateY(-2px);
}

.form-row {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1.5rem;
  margin-bottom: 1.5rem;
  width: 100%;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

label {
  font-weight: 600;
  color: var(--primary);
  font-size: 0.9rem;
}

input, select, textarea {
  padding: 0.75rem 1rem;
  border: 2px solid #e2e8f0;
  border-radius: 0.5rem;
  font-size: 1rem;
  transition: all 0.3s ease;
}

input:focus, select:focus, textarea:focus {
  border-color: var(--secondary);
  outline: none;
  box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.2);
}

/* Service section styling */
#services, #servicePrice {
  flex: 1;
}

.form-row button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.form-row button:hover {
  background: var(--dark);
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 86, 179, 0.2);
}

#selectedServices {
  margin-bottom: 1.5rem;
}

.service-item {
  background: var(--light);
  padding: 1rem;
  border-radius: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0.75rem;
  border-left: 3px solid var(--primary);
}

.service-item span {
  font-weight: 500;
}

.service-item button {
  background: var(--error);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.service-item button:hover {
  background: #c82333;
  transform: translateY(-2px);
}

textarea {
  resize: vertical;
  min-height: 100px;
}

button[type="submit"] {
  background: var(--accent);
  color: white;
  width: auto;
  padding: 1rem 2rem;
  border: none;
  border-radius: 0.5rem;
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: block;
  margin-top: 1.5rem;
}

button[type="submit"]:hover {
  background: #38a169;
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(72, 187, 120, 0.3);
}

@media (max-width: 768px) {
  .form-row {
    grid-template-columns: 1fr;
  }
}
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Lead Details</h2>
    <ul>
      <li onclick="location.href='/dashboard'">Dashboard</li>
      <li onclick="location.href='/new-leads'" style="background: #ff6600;">New Leads</li>
      <li onclick="location.href='/customers'">Customer</li>
      <li onclick="location.href='/add-services'">Add Services</li>
    </ul>
  </div>
  
  <div class="main-content">
    <div class="header">
      <h2>Add New Lead</h2>
      <a href="/logout" class="logout-btn">Logout</a>
    </div>
    
    <form id="newLeadForm">
      <div class="form-row">
        <div class="form-group">
          <label for="customerName">Customer Name:</label>
          <input type="text" id="customerName" name="customerName" required>
        </div>
        <div class="form-group">
          <label for="mobile">Mobile No:</label>
          <input type="tel" id="mobile" name="mobile" required>
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="fatherName">Father's Name:</label>
          <input type="text" id="fatherName" name="fatherName">
        </div>
        <div class="form-group">
          <label for="spouseName">Spouse Name:</label>
          <input type="text" id="spouseName" name="spouseName">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="motherName">Mother's Name:</label>
          <input type="text" id="motherName" name="motherName">
        </div>
        <div class="form-group">
          <label for="aadhar">Aadhar Card No:</label>
          <input type="text" id="aadhar" name="aadhar">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="pan">PAN No:</label>
          <input type="text" id="pan" name="pan">
        </div>
        <div class="form-group">
          <label for="company">Company Name:</label>
          <input type="text" id="company" name="company">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="email">Email ID:</label>
          <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
          <label for="gst">GST No:</label>
          <input type="text" id="gst" name="gst">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="cin">CIN No:</label>
          <input type="text" id="cin" name="cin">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="services">Add Services:</label>
          <select id="services" name="services">
            
            <option value="GST Filing">GST Filing</option>
            
          </select>
        </div>
        <div class="form-group">
          <label for="servicePrice">Service Price:</label>
          <input type="number" id="servicePrice" name="servicePrice" min="0" step="0.01">
        </div>
        <div class="form-group" style="flex-basis: 100%; margin-top: 10px;">
          <button type="button" onclick="addService()">Add Service</button>
        </div>
      </div>
      
      <div id="selectedServices"></div>
      
      <div class="form-row">
        <div class="form-group" style="flex-basis: 100%;">
          <label for="note">Note:</label>
          <textarea id="note" name="note" rows="3"></textarea>
        </div>
      </div>
      
      <button type="submit">Submit Lead</button>
    </form>
  </div>

  <script>
    let services = [];
    function allservices(){
      let allservice=[
    "PAN Correction",
    "PAN Application",
    "TAN Application",
    "PF Transfer",
    "PF Withdrawal",
    "PF KYC",
    "PF Return",
    "ESI Return",
    "Income Tax Return",
    "Financial Statement Preparation",
    "Company Formation",
    "Post Incorporation Services",
    "Annual Compliance",
    "LLP Formation",
    "Partnership Firm Registration",
    "Trust Registration",
    "80G Application",
    "12A Application",
    "Darpan Registration",
    "GST Registration",
    "GSTR-1",
    "GSTR-3B",
    "CMP-08",
    "GST Closure",
    "GST Final Return",
    "GST Amendment",
    "Rent Agreement",
    "Affidavit",
    "Notary Services",
    "Sale Agreement",
    "Sale Deed",
    "Rectification Deed",
    "Gift Deed",
    "MOU",
    "Discharge Deed",
    "DTD-Deposit of Title Deed",
    "HUF-Deed",
    "Partition Deed",
    "Partnership Deed",
    "Amendment in Partnership Deed",
    "FSSAI Registration",
    "ISO Certification",
    "Karnataka Shop and Establishment Registration",
    "UDYAM",
    "Trade Licence",
    "Auditing",
    "RWA Formation",
    "School Establishment",
    "Professional Tax Registration",
    "PF Registration",
    "ESI Registration",
    "Legal Verification of Property",
    "Khata Transfer",
    "Khata Making",
    "EC Application",
    "Trademark Registration",
    "Passport Services",
    "BESCOM Name Transfer",
    "PSARA Licence",
    "Import Export Code",
    "Name Change Services",
    "RERA Licence",
    "TDS Payment 26QB",
    "TDS Return for NRI Cases",
    "Form 15CA/CB",
    "Digital Signature",
    "Estamp Services",
    "Marriage Registration",
    "Project Report",
    "Aadhar Changes"
];
      let service = document.getElementById('services');
      allservice.forEach((s)=>{
        const option = document.createElement('option');
            option.value = s; 
            option.textContent=s;
            service.appendChild(option);
      })
    

    }
    allservices()
    function addService() {
      const serviceSelect = document.getElementById('services');
      const priceInput = document.getElementById('servicePrice');
      
      if (!priceInput.value || isNaN(priceInput.value)) {
        alert('Please enter a valid price');
        return;
      }
      
      const service = {
        name: serviceSelect.options[serviceSelect.selectedIndex].text,
        price: parseFloat(priceInput.value).toFixed(2)
      };
      
      services.push(service);
      updateServiceDisplay();
      priceInput.value = '';
    }
    
    function removeService(index) {
      services.splice(index, 1);
      updateServiceDisplay();
    }
    
    function updateServiceDisplay() {
      const container = document.getElementById('selectedServices');
      container.innerHTML = '';
      
      services.forEach((service, index) => {
        const div = document.createElement('div');
        div.className = 'service-item';
        div.innerHTML = `
          <span>${service.name} - ₹${service.price}</span>
          <button type="button" onclick="removeService(${index})">Remove</button>
        `;
        container.appendChild(div);
      });
    }
    
    document.getElementById('newLeadForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      if (services.length === 0) {
        alert('Please add at least one service');
        return;
      }
      
      try {
        const formData = new FormData(this);
        const customer = {};
        
        for (const [key, value] of formData.entries()) {
          customer[key] = value;
        }
        
        const submissionData = {
          customer: customer,
          services: services
        };
        
        const response = await fetch('/submit', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(submissionData)
        });
        
        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message || 'Server error');
        }
        
        alert('Lead added successfully!');
        this.reset();
        services = [];
        updateServiceDisplay();
        
      } catch (error) {
        console.error('Error:', error);
        alert(`Failed to add lead: ${error.message}`);
      }
    });
  </script>
</body>
</html>
